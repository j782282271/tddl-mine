?????????????
0??????????????????ConfigDataHandlerCity????appName???UnitConfigDataHandlerFactory??
UnitConfigDataHandlerFactory.getConfigDataHandler ????PreheatDataHandler??????????apolloDataHandler??DiamondDataHandler
PreheatDataHandler.getData()???????

1??TGroupDataSource??GroupConfigManager
TGroupDataSource.init()->GroupConfigManager.init()-->doInit():
doinit()?????0????????Handler????????????
com.taobao.tddl.jdbc.group_V2.4.1_tgou_wms??wms_m1:r2w10,wms_s1:r10w0,wms_s2:r10w0
parse()???????????????????datasource?????§Ö???MyDataSourceFetcher.getDataSource()???????¡Â???????initAtomDataSource()?????????????ExtensionLoader??????????§Ö?TAtomDataSource???????
??TAtomDataSource????DataSourceWrapper?????›ÔGroupConfigManager.dataSourceWrapperMap?§³?
??????§»DataSourceWrapper,????GroupConfigManager????????¦²?readDBSelectorWrapper??writeDBSelectorWrapper

2??TAtomDataSource??TAtomDsConfHandle   ???????????datasource???????master????slave
TAtomDataSource.init()??appName, dsKey??wms_m1:r2w10??????TAtomDsConfHandle??????TAtomDsConfHandle.init()
???§Ú????0????????Handler????????????????????????????
com.taobao.tddl.atom.global.wms_m1-->port=3306 dbName=wms dbStatus=RW dbType=mysql ip=10.10.5.11
com.taobao.tddl.atom.app.wms.wms_m1-->userName=tiangou minPoolSize=1 maxPoolSize=100 connectionProperties=autoReconnect=true;connectionInitSql=set names utf8mb4;
com.taobao.tddl.atom.passwd.wms.mysql.tiangou-->tiangou123
??????????›ÔTAtomDsConfDO??????,TAtomDsConfHandle.convertTAtomDsConf2DruidConf()????????TAtomDsConfDO???????
DruidDataSource??????????›ÔTAtomDsConfHandle???????
TAtomDataSource static cacheConfHandleMap,?§Ò?????TAtomDsConfHandle




???????dataSource?????
0???????????TGroupDataSource???mybatis????????????????DataSource????????getConnection??????????TGroupDataSource??getConnection???????????datasource????
TGroupDataSource.getConnection()?????§µ?return new TGroupConnection(this)????????TGroupConnection??
2???????TGroupConnection?????jdbc??Connection?????????prepareStatement??so????TGroupConnection?????????????????
???§Õ?????new TGroupPreparedStatement(tGroupDataSource,this,sql,this.tGroupDataSource.getAppName());
3???????TGroupPreparedStatement?????jdbc??PreparedStatement????????????executeQuery,???????TGroupPreparedStatement??executeQuery??????
  3.1????????????? Connection conn = tGroupConnection.getBaseConnection(sql, gotoRead)???connection
       getBaseConnection??ThreadLocalDataSourceIndex.getIndex()????TDDLRWRounter???????ThreadLocal?????index?????select?????datasoure
  3.2??3.1?§Ù???null????§µ?tGroupDataSource.getDBSelector(gotoRead).tryExecute(executeQueryTryer);???§Ý????executeQueryTryer??tryOnDataSource?????????§Ù???????
       createNewConnection??executeQueryOnConnection??????createPreparedStatementInternal??
     3.2.1??tGroupConnection.createNewConnection???????DataSourceWrapper??DruidDataSource??getConnection????
     3.2.2??createPreparedStatementInternal???????DruidDataSource??prepareStatement????
     3.2.3??????prepareStatement??executeQuery??????§Ó??


